#!/usr/bin/env php
<?php
require dirname(__FILE__) . '/../vendor/autoload.php';

use Symfony\Component\DependencyInjection\ContainerBuilder;
use Symfony\Component\DependencyInjection\Reference;

use Http\Adapter\Guzzle6\Client;

use Ubi\Deploy\Deploy;
use Ubi\Deploy\Service\CloudProvider;
use Ubi\Deploy\Service\JenkinsManager;


$container = new ContainerBuilder();

$container->register('http_client', Client::class);
$container->register(CloudProvider::class, CloudProvider::class)
    ->addArgument(new Reference('http_client'));
$container->register(JenkinsManager::class, JenkinsManager::class)
    ->addArgument(new Reference('http_client'));
$container->register('deploy', Deploy::class)
    ->setAutowired(true)
    ->setPublic(true);
$container->compile();
return $container->get('deploy')->run();